###############################
## Auto-generated by:        ##
##         Ansible           ##
## Don't do changes by hand  ##
## Role: matiferrigno.bacula ##
###############################

{% for stg in bacula_storages | default([]) %}

Storage {
    Name = "stg-{{ stg.name }}"
    Address = {{ stg.fqdn }}
    SDPort = {{ stg.port | default('9103') }}
    Password = "{{ stg.pass | default("changeme!") }}"
    Device = FileStorage-{{ stg.device | default("default") }}
    Media Type = {{ stg.media_type | default("File") }}
    Maximum Concurrent Jobs =  {{ stg.maximum_concurrent_jobs | default(500) }}
    {% if stg.tls_enabled | default(true) | bool %}
    TLS Require = {{ stg.tls_require | default(true) | bool }}
    TLS Certificate = {{ stg.tls_certificate | default("/etc/bacula/certs/crt/"stg.name".crt") }}
    TLS CA Certificate File = {{ stg.tls_ca_certificate | default("/etc/bacula/certs/crt/ca.crt") }}
    {% endif %}
    {% for element in stg.additional_options | default([]) %}
    {% if element.enabled|default(true)|bool %}
      {% if element.comment|d() %}
      {%   for line in element.comment.split('\n') | list %}
      # {{ line }}
      {%   endfor %}
      {% endif %}
      {{ element.name }} = {{ element.value }}
    {% endif %}
    {% endfor %}
}

{% endfor %}