###############################
## Auto-generated by:        ##
##         Ansible           ##
## Don't do changes by hand  ##
## Role: matiferrigno.bacula ##
###############################

{% for item in bacula_storages | default([]) %}

Storage {
    Name = "stg-{{ item.name }}"
    Address = {{ item.fqdn }}
    SDPort = {{ item.port | default('9103') }}
    Password = "{{ item.pass | default("changeme!") }}"
    Device = FileStorage-{{ item.device | default("default") }}
    Media Type = {{ item.media_type | default("File") }}
    Maximum Concurrent Jobs =  {{ item.maximum_concurrent_jobs | default(500) }}
    {% if item.tls_enabled | default(true) | bool %}
    TLS Require = {{ item.tls_require | default(true) | bool }}
    TLS Certificate = {{ item.tls_certificate | default("/etc/bacula/certs/crt/"item.name".crt") }}
    TLS CA Certificate File = {{ item.tls_ca_certificate | default("/etc/bacula/certs/crt/bacula-ca.crt") }}
    {% endif %}
    {% for opt in item.extra_options | default([]) %}
    {% if opt.enabled|default(true)|bool %}
      {% if opt.comment|d() %}
      {%   for line in opt.comment.split('\n') | list %}
      # {{ line }}
      {%   endfor %}
      {% endif %}
      {{ opt.name }} = {{ opt.value }}
    {% endif %}
    {% endfor %}
}

{% endfor %}