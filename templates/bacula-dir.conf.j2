###############################
## Auto-generated by:        ##
##         Ansible           ##
## Don't do changes by hand  ##
## Role: matiferrigno.bacula ##
###############################

###############################
## Bacula Director           ##
###############################

Director {

  ###########
  ## Basic ##
  ###########
  Name = {{ bacula_dir_name }}
  Description = "{{ bacula_dir_description }}"
  DIRport = {{ bacula_dir_port }}
  DIRAddress = {{ bacula_dir_address }}
  QueryFile = {{ bacula_dir_query_file }}
  WorkingDirectory ={{ bacula_dir_working_directory }}
  PidDirectory = {{ bacula_dir_pid_directory }}
  Maximum Concurrent Jobs = {{ bacula_dir_maximum_concurrent_jobs }}
  Password = "{{ bacula_dir_pass }}"
  Messages = {{ bacula_dir_messages }}
  Heartbeat Interval = {{ bacula_dir_heartbeat_interval }}

  #########
  ## TLS ##
  #########
{% if bacula_dir_tls_enabled|bool %}
  TLS Enable = yes
  TLS Require = {{ bacula_dir_tls_require }}
  TLS Verify Peer = {{ bacula_dir_tls_verify_peer }}
  TLS Certificate = {{ bacula_dir_tls_certificate }}
  TLS Key = {{ bacula_dir_tls_key }}
  TLS CA Certificate File = {{ bacula_dir_tls_ca_certificate }}
{% else %}
  TLS Enabled = no
{% endif %}

  ###################
  ## Other options ##
  ###################
{% for element in bacula_dir_additional_options %}
{% if element.enabled|bool %}
  {% if element.comment is defined %}
  {%   for line in element.comment.split('\n') | list %}
  # {{ line }}
  {%   endfor %}
  {% endif %}
  {{ element.name }} = {{ element.value }}
{% endif %}
{% endfor %}

}

@/etc/bacula/conf.d/catalog.conf
@/etc/bacula/conf.d/messages.conf
@/etc/bacula/conf.d/jobdefs.conf

########################################
## Include all clients configuration  ##
########################################
@|"find /etc/bacula/clients.d -name '*.conf' -type f -exec echo @{} \;"
