---

###
# Schedules
###

schedule_DailyFI_Weekly: |
  {% set res = [ ] %}
  {% set runs = [ "Level=Full sun at ", "Level=Incremental mon-sat at "] %}
  {% for h in range(24) %}
  {% for m in ['00','30'] %}
  {%
    if res.append(
      {
        'name': 'DailyFI-Weekly-'+'%02d' | format(h)|string+m,
        'run': runs | map('regex_replace', '^(.*) at $', '\\1 at '+h|string+':'+m) | list
      }
    )
  %}
  {% endif %}
  {% endfor %}
  {% endfor %}
  {{ res }}

schedule_DailyFDI_Biweekly: |
  {% set res = [ ] %}
  {% set runs = [ "Level=Full 1st,3rd sun at ", "Level=Differential 2nd,4th,5th sun at ", "Level=Incremental mon-sat at "] %}
  {% for h in range(24) %}
  {% for m in ['00','30'] %}
  {%
    if res.append(
      {
        'name': 'DailyFDI-Biweekly-'+'%02d' | format(h)|string+m,
        'run': runs | map('regex_replace', '^(.*) at $', '\\1 at '+h|string+':'+m) | list
      }
    )
  %}
  {% endif %}
  {% endfor %}
  {% endfor %}
  {{ res }}

schedule_DailyFDI_Monthly: |
  {% set res = [ ] %}
  {% set runs = [ "Level=Full 1st sun at ", "Level=Differential 2nd,3rd,4th,5th sun at ", "Level=Incremental mon-sat at "] %}
  {% for h in range(24) %}
  {% for m in ['00','30'] %}
  {%
    if res.append(
      {
        'name': 'DailyFDI-Monthly-'+'%02d' | format(h)|string+m,
        'run': runs | map('regex_replace', '^(.*) at $', '\\1 at '+h|string+':'+m) | list
      }
    )
  %}
  {% endif %}
  {% endfor %}
  {% endfor %}
  {{ res }}

bacula__default__schedules: "{{ schedule_DailyFI_Weekly + schedule_DailyFDI_Biweekly + schedule_DailyFDI_Monthly }}"

bacula_schedules: |
  {{
    bacula__default__schedules +
    bacula_schedules_custom | default([])
  }}
